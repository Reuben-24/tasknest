(()=>{"use strict";class e{constructor(e,t){this.id=Date.now().toString(),this.name=e,this.dueDate=t,this.isComplete=!1,this.tasks=[]}addTask(e,n,o){const d=new t(e,n,o);this.tasks.push(d)}}class t{constructor(e,t,n){this.id=Date.now().toString(),this.name=e,this.description=t,this.priority=n,this.isComplete=!1}}const n="myProjects";function o(e){a(c().map((t=>t.id===e.id?e:t)))}function d(e){const t=c().find((t=>t.id===e));if(t)return t;console.error("Project not found:",e)}function c(){const o=localStorage.getItem(n);return o?JSON.parse(o).map((n=>{const o=new e(n.name,n.dueDate);return o.id=n.id,o.isComplete=n.isComplete,o.tasks=n.tasks.map((e=>{const n=new t(e.name,e.description,e.priority);return n.id=e.id,n.isComplete=e.isComplete,n})),o})):[]}function a(e){const t=JSON.stringify(e);localStorage.setItem(n,t)}function s(e){e.addEventListener("click",(t=>{const n=e.getBoundingClientRect();(t.clientY<n.top||t.clientY>n.bottom||t.clientX<n.left||t.clientX>n.right)&&e.close()}))}const r=document.querySelector("#projects-list-menu"),i=document.querySelector("#content-card"),l=document.querySelector("#create-project-dialog"),u=document.querySelector("#create-project-form"),m=document.querySelector("#project-name"),p=document.querySelector("#project-due-date"),C=document.querySelector("#add-task-dialog"),h=document.querySelector("#add-task-form"),k=document.querySelector("#task-name"),v=document.querySelector("#task-description"),j=document.querySelector("#task-priority"),E=document.querySelector("#task-details-dialog"),y=document.querySelector("#task-name-h2"),g=document.querySelector("#task-priority-para"),f=document.querySelector("#task-status-para"),S=document.querySelector("#task-description-para"),b=document.querySelector("#toggle-task-status-button"),w=document.querySelector("#delete-task-button"),x=document.querySelector("#adjust-due-date-dialog"),q=document.querySelector("#adjust-due-date-form"),I=document.querySelector("#adjust-due-date");function L(e,t){const n=d(e),o=n.tasks.find((e=>e.id===t));o&&(y.textContent=o.name,g.textContent=`Priority: ${o.priority}`,f.textContent="Status: "+(o.isComplete?"Complete":"Active"),S.textContent=`Description: ${o.description||"N/A"}`,E.dataset.projectId=n.id,E.dataset.taskId=o.id,E.showModal())}function N(){r.replaceChildren();const e=c();for(const t of e){const e=document.createElement("li");e.textContent=t.name,e.dataset.projectId=t.id,e.addEventListener("click",(()=>{D(e.dataset.projectId)})),r.appendChild(e)}const t=document.createElement("li");t.textContent="Create New Project +",t.id="create-project-menu-item",t.addEventListener("click",(()=>{l.showModal()})),r.appendChild(t)}function D(e){i.replaceChildren();const t=d(e),n=document.createElement("div");n.className="project-details";const s=document.createElement("div"),r=document.createElement("div"),l=document.createElement("h2");l.textContent=t.name;const u=document.createElement("div");u.className="project-property";const m=document.createElement("p"),p=document.createElement("strong");p.textContent="Due Date:",m.appendChild(p),m.appendChild(document.createTextNode(` ${function(e){if(!e)return e;const t=new Date(e);return new Intl.DateTimeFormat("en-AU",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}).format(t)}(t.dueDate)||"N/A"}`));const k=document.createElement("button");k.className="project-details-button",k.id="adjust-due-date-button",k.textContent="Adjust",k.addEventListener("click",(()=>{x.showModal()})),u.appendChild(m),u.appendChild(k);const v=document.createElement("div");v.className="project-property";const j=document.createElement("p"),E=document.createElement("strong");E.textContent="Status:",j.appendChild(E),j.appendChild(document.createTextNode(" "+(t.isComplete?"Complete":"Active")));const y=document.createElement("button");y.className="project-details-button",y.id="toggle-complete-button",y.textContent="Toggle",y.addEventListener("click",(()=>{const t=d(e);t.isComplete=!t.isComplete,o(t),D(e)})),v.appendChild(j),v.appendChild(y),r.appendChild(l),r.appendChild(u),r.appendChild(v);const g=document.createElement("div"),f=document.createElement("h3");f.textContent="Tasks";const S=document.createElement("ul");if(t.tasks&&t.tasks.length>0)t.tasks.forEach((e=>{const n=document.createElement("li"),o=document.createElement("div");o.textContent=e.name;const d=document.createElement("div");d.textContent=`${e.priority} priority`,n.appendChild(o),n.appendChild(d),n.addEventListener("click",(()=>{L(t.id,e.id)})),S.appendChild(n)}));else{const e=document.createElement("li");e.textContent="No Tasks Yet",S.appendChild(e)}g.appendChild(f),g.appendChild(S),s.appendChild(r),s.appendChild(g);const b=document.createElement("div");b.id="project-details-bottom-buttons-container";const w=document.createElement("button");w.className="project-details-button",w.id="add-task-button",w.textContent="Add New Task";const q=document.createElement("button");q.className="project-details-button",q.id="delete-project-button",q.textContent="Delete Project",b.appendChild(w),b.appendChild(q),n.appendChild(s),n.appendChild(b),i.appendChild(n),w&&w.addEventListener("click",(()=>{h.dataset.projectId=e,C.showModal()})),k&&k.addEventListener("click",(()=>{x.dataset.projectId=e,x.showModal()})),y&&y.addEventListener("click",(()=>{})),q&&q.addEventListener("click",(()=>{var e;confirm(`Are you sure you want to delete "${t.name}"?`)&&(e=t.id,a(c().filter((t=>t.id!==e))),N(),T())}))}function T(){i.replaceChildren(),i.innerHTML='\n        <button id="create-project-button">\n            <div id="text">Create New Project</div>\n            <svg class="button-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>\n            </svg>\n        </button>\n    ';const e=document.querySelector("#create-project-button");l&&e.addEventListener("click",(()=>{l.showModal()}))}document.addEventListener("DOMContentLoaded",(()=>{q&&(q.addEventListener("submit",(e=>{e.preventDefault();const t=I.value,n=d(x.dataset.projectId);n.dueDate=t,o(n),D(x.dataset.projectId),x.close()})),s(x)),u&&(u.addEventListener("submit",(t=>{t.preventDefault();const n=new e(m.value,p.value);!function(e){const t=c();t.push(e),a(t)}(n),l.close(),N(),D(n.id)})),s(l)),h&&(h.addEventListener("submit",(e=>{e.preventDefault();const t=d(h.dataset.projectId);t.addTask(k.value,v.value,j.value),o(t),C.close(),D(t.id)})),s(C)),b&&w&&E.addEventListener("click",(e=>{if(e.target.closest("#toggle-task-status-button")){console.log("Toggle button clicked");const e=d(E.dataset.projectId),t=e.tasks.findIndex((e=>e.id===E.dataset.taskId));console.log("Found project:",e),console.log("Task index:",t),-1!==t&&(e.tasks[t].isComplete=!e.tasks[t].isComplete,o(e),L(E.dataset.projectId,E.dataset.taskId))}else if(e.target.closest("#delete-task-button")){const e=d(E.dataset.projectId),t=e.tasks.findIndex((e=>e.id===E.dataset.taskId));-1!==t&&(e.tasks.splice(t,1),o(e),E.close(),D(E.dataset.projectId))}})),s(E),N(),T()}))})();